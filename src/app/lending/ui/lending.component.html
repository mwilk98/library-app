<div class="container h-100 d-flex justify-content-center">
  <h1 class="text-center">Wypożyczenia</h1>
  <p-button [routerLink]="'/add-lending'" icon="pi pi-plus"></p-button>
  <p-confirmDialog
    [style]="{ width: '50vw' }"
    [baseZIndex]="10000"
    rejectButtonStyleClass="p-button-text"
    acceptLabel="Tak"
    rejectLabel="Nie"
  ></p-confirmDialog>
  <p-dialog
    header="Usunięto"
    [(visible)]="displayBasic"
    [style]="{ width: '50vw' }"
  >
    <p>Usunięto wypożyczenie</p>
    <ng-template pTemplate="footer">
      <p-button
        icon="pi pi-check"
        (click)="displayBasic = false"
        label="Ok"
        styleClass="p-button-text"
      ></p-button>
    </ng-template>
  </p-dialog>
  <p-dialog
    header="Zmieniono status"
    [(visible)]="displayStatusChange"
    [style]="{ width: '50vw' }"
  >
    <p>Zmieniono status wypożyczenia</p>
    <ng-template pTemplate="footer">
      <p-button
        icon="pi pi-check"
        (click)="displayStatusChange = false"
        label="Ok"
        styleClass="p-button-text"
      ></p-button>
    </ng-template>
  </p-dialog>

  <div class="table-responsive">
    <p-table
      [value]="lendings"
      styleClass="p-datatable-lg"
      responsiveLayout="scroll"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>#</th>
          <th>Książka</th>
          <th>Uczeń</th>
          <th>Data Wypożyczenia</th>
          <th>Status</th>
          <th>Opcje</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-lending>
        <tr>
          <td>{{ lending.id }}</td>
          <td>
            {{ books[lending.idStudent].title }}
            {{ books[lending.idStudent].author }}
          </td>
          <td>
            {{ students[lending.idStudent].name }}
            {{ students[lending.idStudent].surname }}
          </td>
          <td>{{ lending.lendingDate | date: "dd/MM/yyyy" }}</td>
          <td *ngIf="lending.status; else elseBlock">
            <button pButton class="p-button-success" (click)="changeLendingStatus(lending.id)">Oddaj</button>
          </td>
          <ng-template #elseBlock> <td>Oddano</td></ng-template>
          <td>
            <button pButton type="button" class="p-button-danger" icon="pi pi-ban" (click)="deleteLending(lending.id)"></button>
            <p-button icon="pi pi-user-edit" (click)="editLending(lending.id)"></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
